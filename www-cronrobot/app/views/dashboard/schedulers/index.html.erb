<div class="head-grid">
<% if @schedulers.empty? %>
<h1>Create your first Scheduler</h1>
<% else %>
<h1>Schedulers</h1>
<% end %>

<a id="display-form" class="create-btn" onclick="displayForm()">
    <span>Create</span>
    <img src="/images/dashboard/icons/create.svg">
</a>
</div>

<form id="scheduler-select" class="form-grid">
    <select required="true" class="select-input">
        <option value="SocketPing">Socket Ping</option>
        <option value="Http">HTTP</option>
        <option value="Ssh">SSH</option>
    </select>
    <a class="create-btn" onclick="submitForm()">
        <span>Create</span>
        <img src="/images/dashboard/icons/create.svg">
    </a>
</form>

<div class="table-grid">
    <% @schedulers.each do |scheduler| %>
        <div class="table-grid-row">
            <div class="state state-<%= @alerts_statuses[scheduler.id]&.dig("state") %>">
                <p><%= @alerts_statuses[scheduler.id]&.dig("state") %> (todo)</p>
            </div>
            <p><%= scheduler.schedule %> (todo)</p>
            <p><%= scheduler.name %> (display type)</p>
            <div class="action-icons">
                
                <a href="<%= Grafana.dashboard_url(scheduler) %>">
                    <img src="/images/dashboard/icons/dashboard.svg"></img>
                </a>

                <% if @alerts_statuses[scheduler.id]&.dig("state") != "paused" %>
                    <a data-confirm="Are you sure?" rel="nofollow" href="/dashboard/schedulers/<%= scheduler.id %>/pause" data-method="post">
                        <img src="/images/dashboard/icons/pause.svg">
                    </a>
                <% else %>
                    <a data-confirm="Are you sure?" rel="nofollow" href="/dashboard/schedulers/<%= scheduler.id %>/unpause" data-method="post">
                        <img src="/images/dashboard/icons/resume.svg">
                    </a>
                <% end %>

                <a href="/dashboard/<%= scheduler.plural_path_name %>/<%= scheduler.id %>">
                    <img src="/images/dashboard/icons/edit.svg"></img>
                </a>

                <a data-confirm="Are you sure?" rel="nofollow" data-method="delete" href="/dashboard/schedulers/<%= scheduler.id %>">
                    <img src="/images/dashboard/icons/delete.svg">
                </a>
            </div>
        </div>
    <% end %>
</div>

<script>
    function displayForm() {
        document.getElementById('display-form').style.display = 'none';
        document.getElementById('scheduler-select').style.display = 'grid';
    }
    function submitForm() {
        let value = document.getElementById('scheduler-select').elements[0].value;
        window.location.href = `/dashboard/schedulers/new/Scheduler${value}`
    }
</script>